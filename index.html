<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>a7lan7is n3t</title>
  <meta name="description" content="">
  <meta name="author" content="">

	<script src="js/jquery-1.7.1.min.js"></script>
	<script src="js/jquery.mousewheel-min.js"></script>
	<script src="js/jquery.terminal-0.8.8.min.js"></script>
	<!-- <link href="css/jquery.terminal.css" rel="stylesheet"/> -->
	<link href="css/a7lan7is.css" rel="stylesheet"/>

	<script>
	
	
	var a7lan7is = {
	   groups : {},
	   loadGroups : function (name, category, location, callback) {
	        var data = {};
	        
	        if (typeof name != 'undefined' && name) {
	            data.name = name;
	        }
	        
	        if (typeof category != 'undefined' && category) {
                data.category = category;
            }
	        
	        if (typeof location != 'undefined' && location) {
                data.location = location;
            }
	        
	        $.ajax({
	            url:      "/a7lan7is_n3t/getGroups.php",
	            async:    false,
	            dataType: "json",
	            data:     data,
	            success:  function(json) {
	                if (json) {
		                a7lan7is.groups = json;
		            }
	                if (typeof callback === 'function') {
                        callback();
                    }
	                
	            },
	            error :  function() {
	                
	            }
	        
            });
	    }
	}
    jQuery(document).ready(function($) {
        var groups = {};
        
    	function greetings(term) {
        term.echo('WELCOME TO THE DARK SIDE\n'+
                  'The Dark Ones (C) 2015\n'+
                  'type "help" to see all available commands');
    	}

    	function groupsList(term) {
				a7lan7is.loadGroups(null, null, null, function() {
				    $.each( a7lan7is.groups, function( key, val ) {
	                    term.echo('' + key);
	                  })
	            })
    	}

    	function joinGroup(term, group) {
    		a7lan7is.loadGroups(group, null , null, function() {
    		    if (typeof a7lan7is.groups[group] != 'undefined') {
    		        window.open(a7lan7is.groups[group]['group_link'], '_blank');
                } else {
                    term.echo(group + ' not found');
                }
    		})
    	}
    	
      $('body').terminal(function(command, term) {
			    if (command == 'help') {
			      term.echo("you just typed 'help' command");
			    } else if (command == 'groups') {
			    	groupsList(term);
			    } else if (command.match("^join")) {
			    	var group = command.match("^join (.*)");
			    	joinGroup(term, group[1]);
			    } else {
			      term.echo('unknown command');
			    }
				}, { 
					prompt: 'tty > ', 
					name: 'test',
					greetings: null,
					onInit: function(term) {
          	greetings(term);
      		}
				});

    });
    </script>

</head>

<body>
</body>
</html>