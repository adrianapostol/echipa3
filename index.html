<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>a7lan7is n3t</title>
  <meta name="description" content="">
  <meta name="author" content="">

	<script src="js/jquery-1.7.1.min.js"></script>
	<script src="js/jquery.mousewheel-min.js"></script>
	<script src="js/jquery.terminal-0.9.0_dev.min.js"></script>
	<script src="js/splash.js"></script>
	<!-- <link href="css/jquery.terminal-0.9.0_dev.css" rel="stylesheet"/> -->
	<link href="css/a7lan7is.css" rel="stylesheet"/>

	<script>
    jQuery(document).ready(function($) {
    	function greetings(term) {
    		term.echo(splash);
        term.echo('type "help" to see all available commands');
    	}

    	function groupsList(term) {
				$.getJSON( "groups.json", function( data ) {
				  $.each( data, function( key, val ) {
				  	term.echo('' + key);
				  });
				});
    	}

    	function joinGroup(term, group) {
    		// $.getJSON( "groups.json", function( data ) {
    		// 	var skype = data[group];
    		// 	if (skype) {
    		// 		window.open(skype, '_blank');
    		// 	}
    		// });

    		// sync ajax to avoid popup blocker
			  $.ajax({
			    url:      "groups.json",
			    async:    false,
			    dataType: "json",
			    data:     {},
			    success:  function(data) {
			      var skype = data[group];
    				if (skype) {
    					window.open(skype, '_blank');
    				}
			    }
				});
    	}

      $('body').terminal(function(command, term) {
			    if (command == 'help') {
			      term.echo("you just typed 'help' command");
			    } else if (command == 'groups') {
			    	groupsList(term);
			    } else if (command.match("^join")) {
			    	var group = command.match("^join (.*)");
			    	joinGroup(term, group[1]);
			    } else {
			      term.echo('unknown command');
			    }
				}, { 
					prompt: 'tty > ', 
					name: 'test',
					greetings: null,
					onInit: function(term) {
          	greetings(term);
      		},
      		// height: $(window).innerHeight() * 0.5,
        	// width: $(window).innerWidth(),
					// resizable: false,
				});

    //   $(window).resize(function () {
		  //   $('.terminal').css({
		  //           'width': $(window).innerWidth(),
		  //           'height': $(window).innerHeight() * 0.5,
		  //           'left': '0px',
		  //           'top': '0px'
		  //   });
		  // }).resize();

    });
    </script>

</head>

<body>
</body>
</html>